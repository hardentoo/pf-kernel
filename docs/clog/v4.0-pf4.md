Kudos, mates. Today I'm glad to introduce another pf-kernel version — 4.0-pf4.
Please, grab the
[patch](https://pf.natalenko.name/sources/4.0/patch-4.0-pf4.xz) immediately
and the go on reading this announcement.  
  
This release (except merging stable 4.0.2, of course) brings small but
important fixes. First of all, I've merged two staging patches for BFS from
Con Kolivas: one for fixing build failure, another appears to be one that is
missing in original -ck. Also, I've cleaned up build warning for Alfred's
patches as well as fixed one warning for TOI code. At last, kernel now should
be built fine with TOI disabled (temporary fix, I guess, until Nigel fixes it
properly). Thanks for reporting all the bugs.  
  
Shortlog appended.  
  

    
    
    Adam Honse (1):  
          ALSA: usb-audio: Don't attempt to get Microsoft Lifecam Cinema sample rate  
      
    Akinobu Mita (3):  
          target/file: Fix BUG() when CONFIG_DEBUG_SG=y and DIF protection enabled  
          target/file: Fix UNMAP with DIF protection support  
          target/file: Fix SG table for prot_buf initialization  
      
    Al Viro (1):  
          RCU pathwalk breakage when running into a symlink overmounting something  
      
    Alex Deucher (1):  
          drm/radeon: fix doublescan modes (v2)  
      
    Alexander Ploumistos (1):  
          Bluetooth: ath3k: Add support Atheros AR5B195 combo Mini PCIe card  
      
    Alexei Starovoitov (1):  
          bpf: fix verifier memory corruption  
      
    Alexey Khoroshilov (1):  
          pxa168: fix double deallocation of managed resources  
      
    Alistair Strachan (1):  
          staging: android: sync: Fix memory corruption in sync_timeline_signal().  
      
    Amir Vadai (1):  
          net/mlx4_en: Prevent setting invalid RSS hash function  
      
    Andre Przywara (1):  
          KVM: arm/arm64: check IRQ number on userland injection  
      
    Andreas Faerber (1):  
          ARM: dts: fix mmc node updates for exynos5250-spring  
      
    Andrew Elble (1):  
          NFS: fix BUG() crash in notify_change() with patch to chown_common()  
      
    Andrey Ryabinin (1):  
          ARM: 8320/1: fix integer overflow in ELF_ET_DYN_BASE  
      
    Andrzej Pietrasiewicz (1):  
          usb: gadget: printer: enqueue printer's response for setup request  
      
    Andy Lutomirski (1):  
          x86/asm/decoder: Fix and enforce max instruction size in the insn decoder  
      
    Anna Schumaker (1):  
          NFS: Add a stub for GETDEVICELIST  
      
    Anton Blanchard (1):  
          powerpc/perf: Cap 64bit userspace backtraces to PERF_MAX_STACK_DEPTH  
      
    Archit Taneja (1):  
          clk: qcom: fix RCG M/N counter configuration  
      
    Axel Lin (1):  
          usb: phy: Find the right match in devm_usb_phy_match  
      
    Bartlomiej Zolnierkiewicz (1):  
          clk: samsung: exynos4: Disable ARMCLK down feature on Exynos4210 SoC  
      
    Ben Collins (1):  
          dm crypt: fix deadlock when async crypto algorithm returns -EBUSY  
      
    Ben Serebrin (1):  
          KVM: VMX: Preserve host CR4.MCE value while in guest mode.  
      
    Bo Yan (1):  
          arm64: fix midr range for Cortex-A57 erratum 832075  
      
    Boris Brezillon (1):  
          clk: at91: usb: propagate rate modification to the parent clk  
      
    Brian Norris (4):  
          UBI: account for bitflips in both the VID header and data  
          UBI: fix out of bounds write  
          UBI: initialize LEB number variable  
          UBI: fix check for "too many bytes"  
      
    Charles Keepax (2):  
          ARM: S3C64XX: Use fixed IRQ bases to avoid conflicts on Cragganmore  
          i2c: Mark adapter devices with pm_runtime_no_callbacks  
      
    Chen-Yu Tsai (1):  
          mmc: sunxi: Use devm_reset_control_get_optional() for reset control  
      
    Christoph Hellwig (1):  
          megaraid_sas: use raw_smp_processor_id()  
      
    Christophe Ricard (1):  
          NFC: st21nfcb: Retry i2c_master_send if it returns a negative value  
      
    Con Kolivas (2):  
          ck-4.0: fix undefined reference to 'register_task_migration_notifier'  
          ck-4.0: add missing init task changes  
      
    Dan Carpenter (1):  
          memstick: mspro_block: add missing curly braces  
      
    Daniel Borkmann (1):  
          ebpf: verifier: check that call reg with ARG_ANYTHING is initialized  
      
    Daniel Vetter (1):  
          drm/i915: Dont enable CS_PARSER_ERROR interrupts at all  
      
    Dave Olson (1):  
          powerpc: Fix missing L2 cache size in /sys/devices/system/cpu  
      
    David Henningsson (1):  
          ALSA: hda - fix "num_steps = 0" error on ALC256  
      
    David Hildenbrand (2):  
          KVM: s390: fix handling of write errors in the tpi handler  
          KVM: s390: reinjection of irqs can fail in the tpi handler  
      
    David Rientjes (1):  
          mm, thp: really limit transparent hugepage allocation to local node  
      
    David Sterba (1):  
          btrfs: don't accept bare namespace as a valid xattr  
      
    Dmitry Torokhov (2):  
          i2c: rk3x: report number of messages transmitted  
          drm/i915: cope with large i2c transfers  
      
    Ekaterina Tumanova (1):  
          KVM: s390: Zero out current VMDB of STSI before including level3 data.  
      
    Erez Shitrit (1):  
          IB/mlx4: Fix WQE LSO segment calculation  
      
    Eric Dumazet (7):  
          tcp: tcp_make_synack() should clear skb->tstamp  
          bnx2x: Fix busy_poll vs netpoll  
          tcp: fix possible deadlock in tcp_send_fin()  
          tcp: avoid looping in tcp_send_fin()  
          net: do not deplete pfmemalloc reserve  
          net: fix crash in build_skb()  
          net: rfs: fix crash in get_rps_cpus()  
      
    Eric W. Biederman (12):  
          mnt: Improve the umount_tree flags  
          mnt: Don't propagate umounts in __detach_mounts  
          mnt: In umount_tree reuse mnt_list instead of mnt_hash  
          mnt: Add MNT_UMOUNT flag  
          mnt: Delay removal from the mount hash.  
          mnt: On an unmount propagate clearing of MNT_LOCKED  
          mnt: Don't propagate unmounts to locked mounts  
          mnt: Factor out unhash_mnt from detach_mnt and umount_tree  
          mnt: Factor umount_mnt from umount_tree  
          mnt: Honor MNT_LOCKED when detaching mounts  
          mnt: Fix the error check in __detach_mounts  
          mnt: Update detach_mounts to leave mounts connected  
      
    Ezequiel Garcia (1):  
          stk1160: Make sure current buffer is released  
      
    Felipe Balbi (15):  
          usb: musb: core: fix TX/RX endpoint order  
          usb: define a generic USB_RESUME_TIMEOUT macro  
          usb: musb: use new USB_RESUME_TIMEOUT  
          usb: host: oxu210hp: use new USB_RESUME_TIMEOUT  
          usb: host: fusbh200: use new USB_RESUME_TIMEOUT  
          usb: host: uhci: use new USB_RESUME_TIMEOUT  
          usb: host: fotg210: use new USB_RESUME_TIMEOUT  
          usb: host: r8a66597: use new USB_RESUME_TIMEOUT  
          usb: host: isp116x: use new USB_RESUME_TIMEOUT  
          usb: host: xhci: use new USB_RESUME_TIMEOUT  
          usb: host: ehci: use new USB_RESUME_TIMEOUT  
          usb: host: sl811: use new USB_RESUME_TIMEOUT  
          usb: dwc2: hcd: use new USB_RESUME_TIMEOUT  
          usb: isp1760: hcd: use new USB_RESUME_TIMEOUT  
          usb: core: hub: use new USB_RESUME_TIMEOUT  
      
    Filipe Manana (3):  
          Btrfs: fix log tree corruption when fs mounted with -o discard  
          Btrfs: fix inode eviction infinite loop after cloning into it  
          Btrfs: fix inode eviction infinite loop after extent_same ioctl  
      
    Florian Westphal (1):  
          netfilter: bridge: really save frag_max_size between PRE and POST_ROUTING  
      
    Gavin Shan (1):  
          powerpc/powernv: Don't map M64 segments using M32DT  
      
    Geert Uytterhoeven (1):  
          mmc: tmio: Remove bogus un-initialization in tmio_mmc_host_free()  
      
    Gerald Schaefer (1):  
          mm/hugetlb: use pmd_page() in follow_huge_pmd()  
      
    Giuseppe Cantavenera (1):  
          nfsd: fix nsfd startup race triggering BUG_ON  
      
    Greg Kroah-Hartman (2):  
          Linux 4.0.1  
          Linux 4.0.2  
      
    Gregory CLEMENT (2):  
          ARM: mvebu: Disable CPU Idle on Armada 38x  
          gpio: mvebu: Fix mask/unmask managment per irq chip type  
      
    Gu Zheng (1):  
          md: fix md io stats accounting broken  
      
    H.J. Lu (1):  
          perf tools: Fix perf-read-vdsox32 not building and lib64 install dir  
      
    Hans de Goede (1):  
          Input: alps - fix touchpad buttons getting stuck when used with trackpoint  
      
    Heiko Carstens (1):  
          s390/hibernate: fix save and restore of kernel text section  
      
    Herbert Xu (2):  
          Revert "net: Reset secmark when scrubbing packet"  
          skbuff: Do not scrub skb mark within the same name space  
      
    Howard Mitchell (2):  
          ASoC: pcm512x: Add 'Analogue' prefix to analogue volume controls  
          ASoC: pcm512x: Fix divide by zero issue  
      
    Huacai Chen (2):  
          MIPS: Loongson-3: Add IRQF_NO_SUSPEND to Cascade irqaction  
          MIPS: Hibernate: flush TLB entries earlier  
      
    Hui Wang (1):  
          ALSA: hda - fix headset mic detection problem for one more machine  
      
    Ian Abbott (1):  
          spi: spidev: fix possible arithmetic overflow for multi-transfer message  
      
    Imre Deak (1):  
          drm/i915: vlv: fix save/restore of GFX_MAX_REQ_COUNT reg  
      
    J. Bruce Fields (3):  
          nfsd4: disallow ALLOCATE with special stateids  
          nfsd4: fix READ permission checking  
          nfsd4: disallow SEEK with special stateids  
      
    James Bottomley (1):  
          mvsas: fix panic on expander attached SATA devices  
      
    James Hogan (2):  
          MIPS: KVM: Handle MSA Disabled exceptions from guest  
          MIPS: lose_fpu(): Disable FPU when MSA enabled  
      
    Jann Horn (1):  
          fs: take i_mutex during prepare_binprm for set[ug]id executables  
      
    Jarkko Sakkinen (1):  
          tpm: fix: sanitized code paths in tpm_chip_register()  
      
    Jeff Layton (1):  
          nfs: fix high load average due to callback thread sleeping  
      
    Jens Freimann (1):  
          KVM: s390: fix get_all_floating_irqs  
      
    Jesse Gross (1):  
          udptunnels: Call handle_offloads after inserting vlan tag.  
      
    Jo-Philipp Wich (1):  
          ALSA: hda/realtek - Enable the ALC292 dock fixup on the Thinkpad T450  
      
    Johan Hovold (1):  
          mfd: core: Fix platform-device name collisions  
      
    Johannes Berg (1):  
          mac80211: send AP probe as unicast again  
      
    Joonsoo Kim (1):  
          tracing: Fix incorrect enabling of trace events by boot cmdline  
      
    Junjie Mao (1):  
          driver core: bus: Goto appropriate labels on failure in bus_add_device  
      
    Juri Lelli (1):  
          sched/deadline: Always enqueue on previous rq when dl_task_timer() fires  
      
    K. Y. Srinivasan (2):  
          scsi: storvsc: Fix a bug in copy_from_bounce_buffer()  
          Drivers: hv: vmbus: Fix a bug in the error path in vmbus_open()  
      
    Kailang Yang (1):  
          ALSA: hda/realtek - Fix Headphone Mic doesn't recording for ALC256  
      
    Ken Xue (1):  
          serial: 8250_dw: add support for AMD SOC Carrizo  
      
    Krzysztof Kozlowski (7):  
          compal-laptop: Fix leaking hwmon device  
          compal-laptop: Check return value of power_supply_register  
          power_supply: twl4030_madc: Check return value of power_supply_register  
          power_supply: lp8788-charger: Fix leaked power supply on probe fail  
          power_supply: ipaq_micro_battery: Fix leaking workqueue  
          power_supply: ipaq_micro_battery: Check return values in probe  
          drm/exynos: Enable DP clock to fix display on Exynos5250 and other  
      
    Larry Finger (1):  
          rtlwifi: rtl8192cu: Add new USB ID  
      
    Laurent Pinchart (2):  
          drm: adv7511: Fix DDC error interrupt handling  
          drm: adv7511: Fix nested sleep when reading EDID  
      
    Len Brown (2):  
          sched/idle/x86: Restore mwait_idle() to fix boot hangs, to improve power savings and to improve performance  
          intel_idle: Update support for Silvermont Core in Baytrail SOC  
      
    Linus Torvalds (1):  
          x86: fix special __probe_kernel_write() tail zeroing case  
      
    Linus Walleij (1):  
          drivers: platform: parse IRQ flags from resources  
      
    Lucas Stach (1):  
          spi: imx: read back the RX/TX watermark levels earlier  
      
    Lukas Czerner (1):  
          ext4: make fsync to sync parent dir in no-journal for real this time  
      
    Lv Zheng (1):  
          ACPICA: Utilities: split IO address types from data type models.  
      
    Malcolm Priestley (1):  
          staging: vt6655: use ieee80211_tx_info to select packet type.  
      
    Manish Badarkhe (1):  
          ASoC: davinci-evm: drop un-necessary remove function  
      
    Marcelo Tosatti (1):  
          x86: kvm: Revert "remove sched notifier for cross-cpu migrations"  
      
    Marek Vasut (1):  
          rtlwifi: rtl8192cu: Add new device ID  
      
    Mark Brown (1):  
          i2c: core: Export bus recovery functions  
      
    Mark Rutland (2):  
          arm64: head.S: ensure visibility of page tables  
          arm64: apply alternatives for !SMP kernels  
      
    Mark Salter (1):  
          nfsd: eliminate NFSD_DEBUG  
      
    Markos Chandras (5):  
          MIPS: Malta: Detect and fix bad memsize values  
          MIPS: asm: asm-eva: Introduce kernel load/store variants  
          MIPS: unaligned: Prevent EVA instructions on kernel unaligned accesses  
          MIPS: unaligned: Surround load/store macros in do {} while statements  
          MIPS: unaligned: Fix regular load/store instruction emulation for EVA  
      
    Martin K. Petersen (2):  
          sd: Unregister integrity profile  
          sd: Fix missing ATO tag check  
      
    Max Filippov (3):  
          xtensa: xtfpga: fix hardware lockup caused by LCD driver  
          xtensa: provide __NR_sync_file_range2 instead of __NR_sync_file_range  
          xtensa: ISS: fix locking in TAP network adapter  
      
    Michael Davidson (1):  
          fs/binfmt_elf.c: fix bug in loading of PIE binaries  
      
    Michael Ellerman (2):  
          powerpc/cell: Fix crash in iic_setup_cpu() after per_cpu changes  
          powerpc/cell: Fix cell iommu after it_page_shift changes  
      
    Michael Gernoth (1):  
          ALSA: emu10k1: don't deadlock in proc-functions  
      
    Mike Galbraith (1):  
          sched/idle/x86: Optimize unnecessary mwait_idle() resched IPIs  
      
    Nadav Amit (1):  
          KVM: x86: Fix MSR_IA32_BNDCFGS in msrs_to_save  
      
    NeilBrown (1):  
          md/raid0: fix bug with chunksize not a power of 2.  
      
    Nicholas Bellinger (2):  
          iscsi-target: Convert iscsi_thread_set usage to kthread.h  
          target: Fix COMPARE_AND_WRITE with SG_TO_MEM_NOALLOC handling  
      
    Nicolas Ferre (2):  
          ARM: at91/dt: sama5d3 xplained: add phy address for macb1  
          net/macb: fix the peripheral version test  
      
    Nicolas Iooss (2):  
          Revert "nfs: replace nfs_add_stats with nfs_inc_stats when add one"  
          wl18xx: show rx_frames_per_rates as an array as it really is  
      
    Nishanth Menon (1):  
          C6x: time: Ensure consistency in __init  
      
    Octavian Purdila (1):  
          ACPICA: Tables: Don't release ACPI_MTX_TABLES in acpi_tb_install_standard_table().  
      
    Oleg Nesterov (1):  
          ptrace: fix race between ptrace_resume() and wait_task_stopped()  
      
    Oleksandr Natalenko (5):  
          distro-4.0: bump version to v4.0-pf4  
          distro-4.0: bump version to v4.0-pf4  
          ck-4.0: do not return NULL in void function  
          toi-4.0: fix compiling with TOI disabled  
          toi-4.0: fix warning on TOI_INCREMENTAL disabled  
      
    Oliver Neukum (3):  
          cdc-wdm: fix endianness bug in debug statements  
          HID: add HP OEM mouse to quirk ALWAYS_POLL  
          HID: add quirk for PIXART OEM mouse used by HP  
      
    Pascal Huerst (1):  
          ASoC: cs4271: Increase delay time after reset  
      
    Peng Tao (2):  
          nfs: fix DIO good bytes calculation  
          nfs: remove WARN_ON_ONCE from nfs_direct_good_bytes  
      
    Peter Hurley (1):  
          serial: 8250: Check UART_SCR is writable  
      
    Peter Zijlstra (1):  
          perf/x86/intel: Fix Core2,Atom,NHM,WSM cycles:pp events  
      
    Rabin Vincent (1):  
          tracing: Handle ftrace_dump() atomic context in graph_trace_open()  
      
    Radim Krčmář (2):  
          x86: vdso: fix pvclock races with task migration  
          KVM: use slowpath for cross page cached accesses  
      
    Rafael J. Wysocki (2):  
          ACPICA: Store GPE register enable masks upfront  
          ACPI / scan: Annotate physical_node_lock in acpi_scan_is_offline()  
      
    Russell King (1):  
          ARM: fix broken hibernation  
      
    Sabrina Dubroca (1):  
          e1000: add dummy allocator to fix race condition between mtu change and netpoll  
      
    Sagi Grimberg (3):  
          iser-target: Fix session hang in case of an rdma read DIF error  
          iser-target: Fix possible deadlock in RDMA_CM connection error  
          IB/iser: Fix wrong calculation of protection buffer length  
      
    Scott Wood (1):  
          powerpc/hugetlb: Call mm_dec_nr_pmds() in hugetlb_free_pmd_range()  
      
    Sebastian Hesselbarth (1):  
          ARM: dts: dove: Fix uart[23] reg property  
      
    Sebastian Pöhn (1):  
          ip_forward: Drop frames with attached skb->sk  
      
    Sergej Sawazki (1):  
          ASoC: wm8741: Fix rates constraints values  
      
    Sifan Naeem (1):  
          rc: img-ir: fix error in parameters passed to irq_free()  
      
    Stephen Boyd (3):  
          clk: qcom: Fix i2c frequency table  
          clk: qcom: Properly change rates for ahbix clock  
          clk: qcom: Fix ipq806x LCC frequency tables  
      
    Steve Capper (1):  
          arm64: Adjust EFI libstub object include logic  
      
    Steven Rostedt (1):  
          ring-buffer: Replace this_cpu_*() with __this_cpu_*()  
      
    Steven Rostedt (Red Hat) (1):  
          tools lib traceevent kbuffer: Remove extra update to data pointer in PADDING  
      
    Sudeep Holla (1):  
          drivers/base: cacheinfo: validate device node for all the caches  
      
    Sudip Mukherjee (1):  
          staging: panel: fix lcd type  
      
    Thierry Reding (2):  
          clk: tegra: Register the proper number of resets  
          clk: tegra: Use the proper parent for plld_dsi  
      
    Thomas D (1):  
          tools/power turbostat: Use $(CURDIR) instead of $(PWD) and add support for O= option in Makefile  
      
    Tom Herbert (2):  
          net: add skb_checksum_complete_unset  
          ppp: call skb_checksum_complete_unset in ppp_receive_frame  
      
    Ulrik De Bie (1):  
          Input: elantech - fix absolute mode setting on some ASUS laptops  
      
    Uwe Kleine-König (1):  
          serial: imx: Fix clearing of receiver overrun flag  
      
    Vinson Lee (2):  
          perf symbols: Define STT_GNU_IFUNC for glibc 2.9 and older.  
          perf tools: Work around lack of sched_getcpu in glibc < 2.6.  
      
    Vutla, Lokesh (1):  
          crypto: omap-aes - Fix support for unequal lengths  
      
    Will Deacon (1):  
          arm64: errata: add workaround for cortex-a53 erratum #845719  
      
    Wolfram Sang (1):  
          i2c: mux: use proper dev when removing "channel-X" symlinks  
      
    Yann Droneaud (2):  
          IB/core: disallow registering 0-sized memory region  
          IB/core: don't disallow registering region starting at 0x0  
      
    Yves-Alexis Perez (1):  
          ALSA: hda - Add dock support for ThinkPad X250 (17aa:2226)  
      
    mancha security (1):  
          lib: memzero_explicit: use barrier instead of OPTIMIZER_HIDE_VAR

